name: Deploy vue

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v1

      - name: Setup Node.js
        uses: actions/setup-node@v1
        with:
          node-version: '12'

      - name: setup git auth
        env:
          email: 'artursalomao004@gmail.com'
          username: 'ArthurSalomaoo'
          access_token: ${{ secrets.ACCESS_TOKEN }} # Substitua ACCESS_TOKEN pelo seu token de acesso do GitHub
        run: |
          git config --global credential.helper store
          echo "https://${access_token}:x-oauth-basic@github.com" > ~/.git-credentials
          git config --global user.email $email
          git config --global user.name $username

      - name: Install Dependencies
        run: |
          npm install
          npm install maplibre-gl
          npm install vue@^3 @vue/compiler-sfc@^3 # Instalação específica do Vue.js e do compilador

      - name: Build
        run: |
          npm run build

      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          deploy_key: ${{ secrets.ACCESS_TOKEN }} # Substitua ACCESS_TOKEN pelo seu token de acesso do GitHub
          publish_dir: ./dist
